-- MySQL Script generated by MySQL Workbench
-- Thu May  3 10:32:17 2018
-- Model: New Model    Version: 1.0
-- MySQL Workbench Forward Engineering


-- -----------------------------------------------------
-- Schema public
-- -----------------------------------------------------

-- -----------------------------------------------------
-- Schema public
-- -----------------------------------------------------
CREATE SCHEMA IF NOT EXISTS  public  ;

-- -----------------------------------------------------
-- Table public.TIPO_USUARIO
-- -----------------------------------------------------
CREATE TABLE  public.TIPO_USUARIO (
  TUS_IDTIPO INT NOT NULL ,
  TUS_NOME VARCHAR(255) NOT NULL,
  TUS_DESCRICAO TEXT NOT NULL,
  PRIMARY KEY (TUS_IDTIPO));

-- -----------------------------------------------------
-- Table public.TIPO_DESORDEM
-- -----------------------------------------------------
CREATE TABLE  public.TIPO_DESORDEM (
  TDE_IDTIPO_DESORDEM INT NOT NULL ,
  TDE_NOME VARCHAR(255) NOT NULL,
  TDE_DESCRICAO VARCHAR(255) NULL,
  PRIMARY KEY (TDE_IDTIPO_DESORDEM)
  );
-- -----------------------------------------------------
-- Table public.USUARIO
-- -----------------------------------------------------
CREATE TABLE  public.USUARIO (
  USU_IDUSUARIO BIGINT NOT NULL ,
  USU_LOGIN VARCHAR(45) NOT NULL,
  USU_SENHA VARCHAR(255) NOT NULL,
  USU_NASCIMENTO DATE NULL,
  USU_CPF VARCHAR(15) NULL,
  USU_NOME VARCHAR(255) NULL,
  USU_EMAIL VARCHAR(255) NULL,
  USU_CONFIABILIDADE INT NOT NULL,
  USU_TIPO INT NULL,
  USU_TELEFONE VARCHAR(30) NULL,
  USU_DATA_CADASTRO TIMESTAMP NULL,
  PRIMARY KEY (USU_IDUSUARIO),
  CONSTRAINT TIPO_USUARIO
    FOREIGN KEY (USU_TIPO)
    REFERENCES public.TIPO_USUARIO (TUS_IDTIPO)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION);


-- -----------------------------------------------------
-- Table public.ORG_ORGAO
-- -----------------------------------------------------
CREATE TABLE  public.ORG_ORGAO (
  ORG_IDORGAO INT NOT NULL ,
  ORG_NOME VARCHAR(255) NOT NULL,
  ORG_DESCRICAO VARCHAR(255) NULL,
  PRIMARY KEY (ORG_IDORGAO));

-- -----------------------------------------------------
-- Table public.DESORDEM
-- -----------------------------------------------------
CREATE TABLE  public.DESORDEM (
  DES_IDDESORDEM INT NOT NULL ,
  DES_TIPO INT NOT NULL,
  DES_DESCRICAO TEXT NULL,
  ORG_IDORGAO INT NOT NULL,
  PRIMARY KEY (DES_IDDESORDEM),
  CONSTRAINT fk_TIPO_DESORDEM 
    FOREIGN KEY (DES_TIPO)
    REFERENCES TIPO_DESORDEM (TDE_IDTIPO_DESORDEM) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION,
  CONSTRAINT fk_DES_DESORDEM_ORG_ORGAO1
    FOREIGN KEY (ORG_IDORGAO)
    REFERENCES public.ORG_ORGAO (ORG_IDORGAO)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION);


-- -----------------------------------------------------
-- Table public.DENUNCIA
-- -----------------------------------------------------
CREATE TABLE  public.DENUNCIA (
  DEN_IDDENUNCIA BIGINT NOT NULL ,
  DEN_IDDESORDEM INT NOT NULL,
  DEN_IDUSUARIO BIGINT NOT NULL,
  DEN_DATAHORA_REGISTRO TIMESTAMP NOT NULL,
  DEN_DATAHORA_OCORREU TIMESTAMP NOT NULL,
  DEN_DATAHORA_SOLUCAO TIMESTAMP,
  DEN_STATUS VARCHAR(255) NOT NULL,
  DEN_NIVEL_CONFIABILIDADE INT NOT NULL,
  DEN_LOCAL_DESORDEM GEOMETRY NOT NULL,
  DEN_DESCRICAO TEXT NULL,
  DEN_ANONIMATO SMALLINT,
  PRIMARY KEY (DEN_IDDENUNCIA),
  CONSTRAINT TIPO_DESORDEM
    FOREIGN KEY (DEN_IDDESORDEM)
    REFERENCES public.DESORDEM (DES_IDDESORDEM)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT USUARIO
    FOREIGN KEY (DEN_IDUSUARIO)
    REFERENCES public.USUARIO (USU_IDUSUARIO)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION);


-- -----------------------------------------------------
-- Table public.ARQUIVOS_CARREGADOS
-- -----------------------------------------------------
CREATE TABLE  public.ARQUIVOS_CARREGADOS (
  ARQ_IDARQUIVO INT NOT NULL ,
  ARQ_CONTEUDO BYTEA NOT NULL,
  ARQ_NOME VARCHAR(45) NOT NULL,
  ARQ_DATA_ENVIO TIMESTAMP NOT NULL,
  ARQ_TAMANHO INT NOT NULL,
  ARQ_TIPO VARCHAR(100) NOT NULL,
  PRIMARY KEY (ARQ_IDARQUIVO));


-- -----------------------------------------------------
-- Table public.VIDEO
-- -----------------------------------------------------
CREATE TABLE  public.VIDEO (
  VID_IDVIDEO INT NOT NULL,
  VID_IDDENUNCIA BIGINT NOT NULL,
  PRIMARY KEY (VID_IDVIDEO),
  CONSTRAINT fk_VID_VIDEO_ARQ_ARQUIVOS_CARREGADOS1
    FOREIGN KEY (VID_IDVIDEO)
    REFERENCES public.ARQUIVOS_CARREGADOS (ARQ_IDARQUIVO)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT fk_VID_VIDEO_DEN_DENUNCIA1
    FOREIGN KEY (VID_IDDENUNCIA)
    REFERENCES public.DENUNCIA (DEN_IDDENUNCIA)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION);


-- -----------------------------------------------------
-- Table public.FOTO_USUARIO
-- -----------------------------------------------------
CREATE TABLE  public.FOTO_USUARIO (
  FOT_IDUSUARIO BIGINT NOT NULL,
  FOT_IDFOTO INT NOT NULL,
  PRIMARY KEY (FOT_IDUSUARIO),
  CONSTRAINT fk_FOT_FOTO_USUARIO_USU_USUARIO1
    FOREIGN KEY (FOT_IDUSUARIO)
    REFERENCES public.USUARIO (USU_IDUSUARIO)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT fk_FOT_FOTO_USUARIO_ARQ_ARQUIVOS_CARREGADOS1
    FOREIGN KEY (FOT_IDFOTO)
    REFERENCES public.ARQUIVOS_CARREGADOS (ARQ_IDARQUIVO)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION);


-- -----------------------------------------------------
-- Table public.IMAGEM
-- -----------------------------------------------------
CREATE TABLE  public.IMAGEM (
  IMG_IDDENUNCIA BIGINT NOT NULL,
  IMG_IDARQUIVO INT NOT NULL,
  PRIMARY KEY (IMG_IDDENUNCIA, IMG_IDARQUIVO),
  CONSTRAINT fk_IMG_IMAGEM_DEN_DENUNCIA1
    FOREIGN KEY (IMG_IDDENUNCIA)
    REFERENCES public.DENUNCIA (DEN_IDDENUNCIA)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT fk_IMG_IMAGEM_ARQ_ARQUIVOS_CARREGADOS1
    FOREIGN KEY (IMG_IDARQUIVO)
    REFERENCES public.ARQUIVOS_CARREGADOS (ARQ_IDARQUIVO)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION);


-- -----------------------------------------------------
-- Table public.CONFIRMACAO
-- -----------------------------------------------------
CREATE TABLE  public.CONFIRMACAO (
  CON_IDCONFIRMACAO INT NOT NULL ,
  CON_IDDENUNCIA BIGINT NOT NULL,
  CON_COMENTARIO TEXT NULL,
  CON_CONFIRMACAO INT NOT NULL,
  CON_DATA_CONFIRMACAO VARCHAR(45) NULL,
  USU_IDUSUARIO BIGINT NOT NULL,
  PRIMARY KEY (CON_IDCONFIRMACAO),
  CONSTRAINT fk_CON_CONFIRMACAO_DEN_DENUNCIA1
    FOREIGN KEY (CON_IDDENUNCIA)
    REFERENCES public.DENUNCIA (DEN_IDDENUNCIA)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT fk_CON_CONFIRMACAO_USU_USUARIO1
    FOREIGN KEY (USU_IDUSUARIO)
    REFERENCES public.USUARIO (USU_IDUSUARIO)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION);


-- -----------------------------------------------------
-- Table public.REGIAO_ALERTA
-- -----------------------------------------------------
CREATE TABLE  public.REGIAO_ALERTA (
  REG_IDREGIAO_ALERTA INT NOT NULL ,
  USU_IDUSUARIO BIGINT NOT NULL,
  REG_REGIAO_ALERTA POLYGON NULL,
  PRIMARY KEY (REG_IDREGIAO_ALERTA),
  CONSTRAINT fk_REG_REGIAO_ALERTA_USU_USUARIO1
    FOREIGN KEY (USU_IDUSUARIO)
    REFERENCES public.USUARIO (USU_IDUSUARIO)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION);





DROP SEQUENCE IF EXISTS public.TIPO_USUARIO_TUS_IDTIPO_sequence;
CREATE SEQUENCE  public.TIPO_USUARIO_TUS_IDTIPO_sequence;
ALTER TABLE public.TIPO_USUARIO ALTER COLUMN TUS_IDTIPO SET DEFAULT NEXTVAL('public.TIPO_USUARIO_TUS_IDTIPO_sequence');
DROP SEQUENCE IF EXISTS public.USUARIO_USU_IDUSUARIO_sequence;
CREATE SEQUENCE  public.USUARIO_USU_IDUSUARIO_sequence;
ALTER TABLE public.USUARIO ALTER COLUMN USU_IDUSUARIO SET DEFAULT NEXTVAL('public.USUARIO_USU_IDUSUARIO_sequence');
DROP SEQUENCE IF EXISTS public.ORG_ORGAO_ORG_IDORGAO_sequence;
CREATE SEQUENCE  public.ORG_ORGAO_ORG_IDORGAO_sequence;
ALTER TABLE public.ORG_ORGAO ALTER COLUMN ORG_IDORGAO SET DEFAULT NEXTVAL('public.ORG_ORGAO_ORG_IDORGAO_sequence');
DROP SEQUENCE IF EXISTS public.DESORDEM_DES_IDDESORDEM_sequence;
CREATE SEQUENCE  public.DESORDEM_DES_IDDESORDEM_sequence;
ALTER TABLE public.DESORDEM ALTER COLUMN DES_IDDESORDEM SET DEFAULT NEXTVAL('public.DESORDEM_DES_IDDESORDEM_sequence');
DROP SEQUENCE IF EXISTS public.DENUNCIA_DEN_IDDENUNCIA_sequence;
CREATE SEQUENCE  public.DENUNCIA_DEN_IDDENUNCIA_sequence;
ALTER TABLE public.DENUNCIA ALTER COLUMN DEN_IDDENUNCIA SET DEFAULT NEXTVAL('public.DENUNCIA_DEN_IDDENUNCIA_sequence');
DROP SEQUENCE IF EXISTS public.ARQUIVOS_CARREGADOS_ARQ_IDARQUIVO_sequence;
CREATE SEQUENCE  public.ARQUIVOS_CARREGADOS_ARQ_IDARQUIVO_sequence;
ALTER TABLE public.ARQUIVOS_CARREGADOS ALTER COLUMN ARQ_IDARQUIVO SET DEFAULT NEXTVAL('public.ARQUIVOS_CARREGADOS_ARQ_IDARQUIVO_sequence');
DROP SEQUENCE IF EXISTS public.CONFIRMACAO_CON_IDCONFIRMACAO_sequence;
CREATE SEQUENCE  public.CONFIRMACAO_CON_IDCONFIRMACAO_sequence;
ALTER TABLE public.CONFIRMACAO ALTER COLUMN CON_IDCONFIRMACAO SET DEFAULT NEXTVAL('public.CONFIRMACAO_CON_IDCONFIRMACAO_sequence');
DROP SEQUENCE IF EXISTS public.REGIAO_ALERTA_REG_IDREGIAO_ALERTA_sequence;
CREATE SEQUENCE  public.REGIAO_ALERTA_REG_IDREGIAO_ALERTA_sequence;
ALTER TABLE public.REGIAO_ALERTA ALTER COLUMN REG_IDREGIAO_ALERTA SET DEFAULT NEXTVAL('public.REGIAO_ALERTA_REG_IDREGIAO_ALERTA_sequence');
DROP SEQUENCE IF EXISTS public.TIPO_DESORDEM_TDE_IDTIPO_DESORDEM_sequence;
CREATE SEQUENCE  public.TIPO_DESORDEM_TDE_IDTIPO_DESORDEM_sequence;
ALTER TABLE public.TIPO_DESORDEM ALTER COLUMN TDE_IDTIPO_DESORDEM SET DEFAULT NEXTVAL('public.TIPO_DESORDEM_TDE_IDTIPO_DESORDEM_sequence');
