-- MySQL Script generated by MySQL Workbench
-- Mon Apr 30 19:23:46 2018
-- Model: New Model    Version: 1.0
-- MySQL Workbench Forward Engineering

SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='TRADITIONAL,ALLOW_INVALID_DATES';

-- -----------------------------------------------------
-- Schema mapaDaDesordem
-- -----------------------------------------------------

-- -----------------------------------------------------
-- Schema mapaDaDesordem
-- -----------------------------------------------------
CREATE SCHEMA IF NOT EXISTS `mapaDaDesordem` DEFAULT CHARACTER SET utf8 ;
USE `mapaDaDesordem` ;

-- -----------------------------------------------------
-- Table `mapaDaDesordem`.`TIPO_USUARIO`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mapaDaDesordem`.`TIPO_USUARIO` (
  `TUS_IDTIPO` INT NOT NULL AUTO_INCREMENT,
  `TUS_NOME` VARCHAR(255) NOT NULL,
  `TUS_DESCRICAO` TEXT NOT NULL,
  PRIMARY KEY (`TUS_IDTIPO`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mapaDaDesordem`.`USUARIO`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mapaDaDesordem`.`USUARIO` (
  `USU_IDUSUARIO` BIGINT(20) NOT NULL AUTO_INCREMENT,
  `USU_LOGIN` VARCHAR(45) NOT NULL,
  `USU_SENHA` VARCHAR(255) NOT NULL,
  `USU_NASCIMENTO` DATE NULL,
  `USU_CPF` VARCHAR(15) NULL,
  `USU_NOME` VARCHAR(255) NULL,
  `USU_EMAIL` VARCHAR(255) NULL,
  `USU_CONFIABILIDADE` INT NOT NULL,
  `USU_TIPO` INT NULL,
  `USU_TELEFONE` VARCHAR(30) NULL,
  `USU_DATA_CADASTRO` TIMESTAMP NULL,
  PRIMARY KEY (`USU_IDUSUARIO`),
  INDEX `TIP_IDTIPO_idx` (`USU_TIPO` ASC),
  CONSTRAINT `TIPO_USUARIO`
    FOREIGN KEY (`USU_TIPO`)
    REFERENCES `mapaDaDesordem`.`TIPO_USUARIO` (`TUS_IDTIPO`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mapaDaDesordem`.`ORG_ORGAO`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mapaDaDesordem`.`ORG_ORGAO` (
  `ORG_IDORGAO` INT NOT NULL AUTO_INCREMENT,
  `ORG_NOME` VARCHAR(255) NOT NULL,
  `ORG_DESCRICAO` VARCHAR(255) NULL,
  PRIMARY KEY (`ORG_IDORGAO`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mapaDaDesordem`.`DESORDEM`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mapaDaDesordem`.`DESORDEM` (
  `DES_IDDESORDEM` INT NOT NULL AUTO_INCREMENT,
  `DES_TIPO` VARCHAR(255) NOT NULL,
  `DES_NATUREZA` VARCHAR(255) NOT NULL,
  `DES_DESCRICAO` TEXT NULL,
  `ORG_IDORGAO` INT NOT NULL,
  PRIMARY KEY (`DES_IDDESORDEM`),
  INDEX `fk_DES_DESORDEM_ORG_ORGAO1_idx` (`ORG_IDORGAO` ASC),
  CONSTRAINT `fk_DES_DESORDEM_ORG_ORGAO1`
    FOREIGN KEY (`ORG_IDORGAO`)
    REFERENCES `mapaDaDesordem`.`ORG_ORGAO` (`ORG_IDORGAO`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mapaDaDesordem`.`DENUNCIA`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mapaDaDesordem`.`DENUNCIA` (
  `DEN_IDDENUNCIA` BIGINT(20) NOT NULL AUTO_INCREMENT,
  `DES_IDDESORDEM` INT NOT NULL,
  `USU_IDUSUARIO` BIGINT(20) NOT NULL,
  `DEN_DATAHORA_REGISTRO` DATETIME NOT NULL,
  `DEN_DATAORA_OCORREU` DATETIME NOT NULL,
  `DEN_DATAHORA_SOLUCAO` DATETIME NOT NULL,
  `DEN_STATUS` VARCHAR(255) NOT NULL,
  `DEN_NIVEL_CONFIABILIDADE` INT NOT NULL,
  `DEN_LOCAL_DESORDEM` GEOMETRY NOT NULL,
  `DEN_DESCRICAO` TEXT NULL,
  `DEN_ANONIMATO` TINYINT NOT NULL,
  PRIMARY KEY (`DEN_IDDENUNCIA`, `DES_IDDESORDEM`, `USU_IDUSUARIO`),
  INDEX `TIPO_DESORDEM_idx` (`DES_IDDESORDEM` ASC),
  INDEX `USUARIO_idx` (`USU_IDUSUARIO` ASC),
  CONSTRAINT `TIPO_DESORDEM`
    FOREIGN KEY (`DES_IDDESORDEM`)
    REFERENCES `mapaDaDesordem`.`DESORDEM` (`DES_IDDESORDEM`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `USUARIO`
    FOREIGN KEY (`USU_IDUSUARIO`)
    REFERENCES `mapaDaDesordem`.`USUARIO` (`USU_IDUSUARIO`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mapaDaDesordem`.`ARQUIVOS_CARREGADOS`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mapaDaDesordem`.`ARQUIVOS_CARREGADOS` (
  `ARQ_IDARQUIVO` INT NOT NULL AUTO_INCREMENT,
  `ARQ_CONTEUDO` BLOB NOT NULL,
  `ARQ_NOME` VARCHAR(45) NOT NULL,
  `ARQ_DATA_ENVIO` TIMESTAMP NOT NULL,
  `ARQ_TAMANHO` INT NOT NULL,
  `ARQ_TIPO` VARCHAR(100) NOT NULL,
  PRIMARY KEY (`ARQ_IDARQUIVO`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mapaDaDesordem`.`VIDEO`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mapaDaDesordem`.`VIDEO` (
  `VID_IDVIDEO` INT NOT NULL,
  `VID_IDDENUNCIA` BIGINT(20) NOT NULL,
  PRIMARY KEY (`VID_IDVIDEO`, `VID_IDDENUNCIA`),
  INDEX `fk_VID_VIDEO_DEN_DENUNCIA1_idx` (`VID_IDDENUNCIA` ASC),
  CONSTRAINT `fk_VID_VIDEO_ARQ_ARQUIVOS_CARREGADOS1`
    FOREIGN KEY (`VID_IDVIDEO`)
    REFERENCES `mapaDaDesordem`.`ARQUIVOS_CARREGADOS` (`ARQ_IDARQUIVO`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_VID_VIDEO_DEN_DENUNCIA1`
    FOREIGN KEY (`VID_IDDENUNCIA`)
    REFERENCES `mapaDaDesordem`.`DENUNCIA` (`DEN_IDDENUNCIA`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mapaDaDesordem`.`FOTO_USUARIO`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mapaDaDesordem`.`FOTO_USUARIO` (
  `FOT_IDUSUARIO` BIGINT(20) NOT NULL,
  `FOT_IDFOTO` INT NOT NULL,
  PRIMARY KEY (`FOT_IDUSUARIO`, `FOT_IDFOTO`),
  INDEX `fk_FOT_FOTO_USUARIO_ARQ_ARQUIVOS_CARREGADOS1_idx` (`FOT_IDFOTO` ASC),
  CONSTRAINT `fk_FOT_FOTO_USUARIO_USU_USUARIO1`
    FOREIGN KEY (`FOT_IDUSUARIO`)
    REFERENCES `mapaDaDesordem`.`USUARIO` (`USU_IDUSUARIO`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_FOT_FOTO_USUARIO_ARQ_ARQUIVOS_CARREGADOS1`
    FOREIGN KEY (`FOT_IDFOTO`)
    REFERENCES `mapaDaDesordem`.`ARQUIVOS_CARREGADOS` (`ARQ_IDARQUIVO`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mapaDaDesordem`.`IMAGEM`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mapaDaDesordem`.`IMAGEM` (
  `IMG_IDDENUNCIA` BIGINT(20) NOT NULL,
  `IMG_IDARQUIVO` INT NOT NULL,
  PRIMARY KEY (`IMG_IDDENUNCIA`, `IMG_IDARQUIVO`),
  INDEX `fk_IMG_IMAGEM_ARQ_ARQUIVOS_CARREGADOS1_idx` (`IMG_IDARQUIVO` ASC),
  CONSTRAINT `fk_IMG_IMAGEM_DEN_DENUNCIA1`
    FOREIGN KEY (`IMG_IDDENUNCIA`)
    REFERENCES `mapaDaDesordem`.`DENUNCIA` (`DEN_IDDENUNCIA`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_IMG_IMAGEM_ARQ_ARQUIVOS_CARREGADOS1`
    FOREIGN KEY (`IMG_IDARQUIVO`)
    REFERENCES `mapaDaDesordem`.`ARQUIVOS_CARREGADOS` (`ARQ_IDARQUIVO`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mapaDaDesordem`.`CONFIRMACAO`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mapaDaDesordem`.`CONFIRMACAO` (
  `CON_IDCONFIRMACAO` INT NOT NULL AUTO_INCREMENT,
  `DEN_IDDENUNCIA` BIGINT(20) NOT NULL,
  `CON_COMENTARIO` TEXT NULL,
  `CON_CONFIRMACAO` INT(1) NOT NULL,
  `CON_DATA_CONFIRMACAO` VARCHAR(45) NULL,
  `USU_IDUSUARIO` BIGINT(20) NOT NULL,
  PRIMARY KEY (`CON_IDCONFIRMACAO`, `DEN_IDDENUNCIA`, `USU_IDUSUARIO`),
  INDEX `fk_CON_CONFIRMACAO_DEN_DENUNCIA1_idx` (`DEN_IDDENUNCIA` ASC),
  INDEX `fk_CON_CONFIRMACAO_USU_USUARIO1_idx` (`USU_IDUSUARIO` ASC),
  CONSTRAINT `fk_CON_CONFIRMACAO_DEN_DENUNCIA1`
    FOREIGN KEY (`DEN_IDDENUNCIA`)
    REFERENCES `mapaDaDesordem`.`DENUNCIA` (`DEN_IDDENUNCIA`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_CON_CONFIRMACAO_USU_USUARIO1`
    FOREIGN KEY (`USU_IDUSUARIO`)
    REFERENCES `mapaDaDesordem`.`USUARIO` (`USU_IDUSUARIO`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mapaDaDesordem`.`REGIAO_ALERTA`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mapaDaDesordem`.`REGIAO_ALERTA` (
  `REG_IDREGIAO_ALERTA` INT NOT NULL AUTO_INCREMENT,
  `USU_IDUSUARIO` BIGINT(20) NOT NULL,
  `REG_REGIAO_ALERTA` POLYGON NULL,
  PRIMARY KEY (`REG_IDREGIAO_ALERTA`, `USU_IDUSUARIO`),
  INDEX `fk_REG_REGIAO_ALERTA_USU_USUARIO1_idx` (`USU_IDUSUARIO` ASC),
  CONSTRAINT `fk_REG_REGIAO_ALERTA_USU_USUARIO1`
    FOREIGN KEY (`USU_IDUSUARIO`)
    REFERENCES `mapaDaDesordem`.`USUARIO` (`USU_IDUSUARIO`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mapaDaDesordem`.`TIPO_DESORDEM`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mapaDaDesordem`.`TIPO_DESORDEM` (
  `TDE_IDTIPO_DESORDEM` INT NOT NULL AUTO_INCREMENT,
  `TDE_NOME` VARCHAR(255) NOT NULL,
  `TDE_DESCRICAO` VARCHAR(255) NULL,
  `DES_DESORDEM_DES_IDDESORDEM` INT NOT NULL,
  PRIMARY KEY (`TDE_IDTIPO_DESORDEM`, `DES_DESORDEM_DES_IDDESORDEM`),
  INDEX `fk_TDE_TIPO_DESORDEM_DES_DESORDEM1_idx` (`DES_DESORDEM_DES_IDDESORDEM` ASC),
  CONSTRAINT `fk_TDE_TIPO_DESORDEM_DES_DESORDEM1`
    FOREIGN KEY (`DES_DESORDEM_DES_IDDESORDEM`)
    REFERENCES `mapaDaDesordem`.`DESORDEM` (`DES_IDDESORDEM`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;
